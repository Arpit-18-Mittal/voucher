package voucher

import (
	"context"

	"github.com/docker/distribution/reference"
)

// VulnerabilityScanner is an interface which represents a scanners that can be used
// to check an image for vulnerabilities. VulnerabilityScanners implement the Scan
// method, which takes reference.Canonical as input and returns a slice of Vulnerabilities.
type VulnerabilityScanner interface {

	// FailOn sets the minimum Severity to consider an image vulnerable.
	FailOn(Severity)

	// Scan runs a scan against the passed reference.Canonical and returns a slice of
	// Vulnerabilities.
	Scan(context.Context, reference.Canonical) ([]Vulnerability, error)
}
